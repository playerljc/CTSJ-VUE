"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseVBind=exports.getVBindEntrys=exports.hasVBind=void 0;var vue_util_1=require("@ctsj/vue-util"),proxy_1=require("../../core/proxy"),util_1=require("../../shared/util"),util_2=require("./util"),constants_1=require("../../shared/constants");function hasVBind(e){return util_2.hasVAttr(e,constants_1.DIRECT_PREFIX+"bind")}function getVBindEntrys(e){var r=this,a=e.context,n=e.el,e=e.vAttrNames.filter(function(e){return-1!==e.indexOf(constants_1.DIRECT_PREFIX+"bind")}),i=document.createElement(n.tagName),o=[];return e.forEach(function(e){var s,t;e===constants_1.DIRECT_PREFIX+"bind"?(s=n.getAttribute(e),t=util_1.execExpression.call(r,a,s),vue_util_1.isObject(t)&&Object.keys(t).forEach(function(e){var t;proxy_1.isProxyProperty(e)&&(t=constants_1.DIRECT_PREFIX+"bind:"+util_1.pascalCaseToKebabCase(e),i.setAttribute(t,s+"."+e),o.push(t))})):(i.setAttribute(e,n.getAttribute(e)),o.push(e))}),o.map(function(e){var t=util_2.getDirectiveEntry(i,e);return"class"===t.arg||"style"===t.arg?("class"===t.arg&&(t.expression.startsWith("{")&&t.expression.endsWith("}")&&(t.expression="Object("+t.expression+")"),t.value=util_1.execExpression.call(r,a,t.expression),vue_util_1.isArray(t.value)&&(e=t.value,t.value={},e.forEach(function(e){t.value[e]=!0}))),"style"===t.arg&&(0===t.expression.indexOf("{")&&t.expression.lastIndexOf("}")===t.expression.length-1&&(t.expression="Object("+t.expression+")"),t.value=util_1.execExpression.call(r,a,t.expression))):t.arg&&(t.value=util_1.execExpression.call(r,a,t.expression)),t})}function parseVBind(e){var t=e.context,s=e.el,r=e.vAttrNames,a=e.VNode,n=this,r=getVBindEntrys.call(this,{context:t,el:s,vAttrNames:r});return r.forEach(function(t){var s;"key"===t.arg&&(a.key=t.value),"ref"===t.arg?Object.assign(a.data.hook,{insert:function(e){n.$refs[t.value]=e.elm}}):"class"===t.arg?(s={},Object.keys(t.value).forEach(function(e){proxy_1.isProxyProperty(e)&&(s[e]=t.value[e])}),Object.assign(a.data.class,s)):"style"===t.arg?Object.assign(a.data.style,t.value):t.arg.startsWith("data-")?a.data.dataset[util_1.toCamelCase(t.arg.substring("data-".length))]=t.value:a.data.props[t.arg]=t.value}),r}exports.hasVBind=hasVBind,exports.getVBindEntrys=getVBindEntrys,exports.parseVBind=parseVBind;
//# sourceMappingURL=bind.js.map
