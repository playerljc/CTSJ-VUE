{"version":3,"file":"else-if.js","sources":["compiler/directives/else-if.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.parseVElseIf = exports.hasVElseIf = void 0;\r\nvar util_1 = require(\"./util\");\r\nvar constants_1 = require(\"../../shared/constants\");\r\nvar util_2 = require(\"../../shared/util\");\r\n/**\r\n * hasVElseIf - 是否有v-else-if属性\r\n * @param attrNames - Array 所有的指令属性集合\r\n * @return {boolean}\r\n */\r\nfunction hasVElseIf(attrNames) {\r\n    return util_1.hasVAttr(attrNames, constants_1.DIRECT_PREFIX + \"else-if\");\r\n}\r\nexports.hasVElseIf = hasVElseIf;\r\n/**\r\n * parseVElseIf\r\n * @param context - Object 上下文对象\r\n * @param el - HtmlElement 当前元素\r\n * @param parentElement = HtmlElement 父元素\r\n * @return {\r\n *   valid : boolean 链路是否有效\r\n *   result: boolean else的值\r\n * }\r\n */\r\nfunction parseVElseIf(_a) {\r\n    var context = _a.context, el = _a.el, parentElement = _a.parentElement;\r\n    // 说明el是v-for的一个克隆元素\r\n    if (!parentElement) {\r\n        // 寻找el元素的克隆元素\r\n        var groupName = el.getAttribute(constants_1.GROUP_KEY_NAME);\r\n        // 获取含有GROUP_KEY_NAME属性且值等于groupName的元素\r\n        var srcEl = this.templateEl.querySelector(\"[\" + constants_1.GROUP_KEY_NAME + \"=\" + groupName + \"]\");\r\n        if (srcEl) {\r\n            parentElement = srcEl.parentElement;\r\n        }\r\n    }\r\n    if (!parentElement) {\r\n        return {\r\n            valid: false,\r\n            result: false,\r\n        };\r\n    }\r\n    // 获取parentElement中的所有childNodes\r\n    var childNodes;\r\n    if (parentElement.nodeName.toLowerCase() === 'template') {\r\n        childNodes = parentElement.content.childNodes;\r\n    }\r\n    else {\r\n        childNodes = parentElement.childNodes;\r\n    }\r\n    // 获取el在childNodes中的位置\r\n    var elIndex = -1;\r\n    for (var i = 0, len = childNodes.length; i < len; i++) {\r\n        var childNode = childNodes.item(i);\r\n        if (childNode === el) {\r\n            elIndex = i;\r\n            break;\r\n        }\r\n    }\r\n    if (elIndex === -1) {\r\n        return {\r\n            valid: false,\r\n            result: false,\r\n        };\r\n    }\r\n    // 获取elIndex之前第一个v-if的位置\r\n    var firstIfIndex = -1;\r\n    for (var i = elIndex - 1; i >= 0; i--) {\r\n        var childNode = childNodes[i];\r\n        // 如果是元素 && 有v-if属性\r\n        if (util_2.isElementNode(childNode) && util_1.hasVAttr(util_1.getVAttrNames(childNode), constants_1.DIRECT_PREFIX + \"if\")) {\r\n            firstIfIndex = i;\r\n            break;\r\n        }\r\n    }\r\n    if (firstIfIndex === -1) {\r\n        return {\r\n            valid: false,\r\n            result: false,\r\n        };\r\n    }\r\n    // v-if和v-else之前只能包含文本节点或者v-else-if\r\n    var valid = true;\r\n    for (var i = firstIfIndex + 1; i <= elIndex - 1; i++) {\r\n        var childNode = childNodes[i];\r\n        // 如果是文本节点\r\n        if (util_2.isTextNode(childNode)) {\r\n            // 如果文本节点不是''\r\n            if (childNode.nodeValue.trim() !== '') {\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n        else {\r\n            var hasVElseIfAttr = util_1.hasVAttr(util_1.getVAttrNames(childNode), constants_1.DIRECT_PREFIX + \"else-if\");\r\n            // 如果不是v-else-if\r\n            if (!hasVElseIfAttr) {\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return {\r\n        valid: valid,\r\n        result: valid\r\n            ? util_2.execExpression.call(this, context, el.getAttribute(constants_1.DIRECT_PREFIX + \"else-if\"))\r\n            : false,\r\n    };\r\n}\r\nexports.parseVElseIf = parseVElseIf;\r\n"],"names":["Object","defineProperty","exports","value","parseVElseIf","hasVElseIf","util_1","require","constants_1","util_2","attrNames","hasVAttr","DIRECT_PREFIX","_a","childNodes","context","el","parentElement","groupName","getAttribute","GROUP_KEY_NAME","srcEl","this","templateEl","querySelector","valid","result","elIndex","i","len","nodeName","toLowerCase","content","length","childNode","item","firstIfIndex","isElementNode","getVAttrNames","isTextNode","nodeValue","trim","execExpression","call"],"mappings":"aACAA,OAAOC,eAAeC,QAAS,aAAc,CAAEC,OAAO,IACtDD,QAAQE,aAAeF,QAAQG,gBAAa,EAC5C,IAAIC,OAASC,QAAQ,UACjBC,YAAcD,QAAQ,0BACtBE,OAASF,QAAQ,qBAMrB,SAASF,WAAWK,GAChB,OAAOJ,OAAOK,SAASD,EAAWF,YAAYI,cAAgB,WAalE,SAASR,aAAaS,GAClB,IAkBIC,EAlBAC,EAAUF,EAAGE,QAASC,EAAKH,EAAGG,GAAIC,EAAgBJ,EAAGI,cAWzD,GATKA,IAEGC,EAAYF,EAAGG,aAAaX,YAAYY,iBAExCC,EAAQC,KAAKC,WAAWC,cAAc,IAAMhB,YAAYY,eAAiB,IAAMF,EAAY,QAE3FD,EAAgBI,EAAMJ,iBAGzBA,EACD,MAAO,CACHQ,OAAO,EACPC,QAAQ,GAahB,IADA,IAAIC,GAAW,EACNC,EAAI,EAAGC,GAPZf,GADyC,aAAzCG,EAAca,SAASC,cACVd,EAAce,QAGdf,GAHsBH,YAONmB,OAAQL,EAAIC,EAAKD,IAE9C,IADIM,EAAYpB,EAAWqB,KAAKP,MACdZ,EAAI,CAClBW,EAAUC,EACV,MAGR,IAAiB,IAAbD,EACA,MAAO,CACHF,OAAO,EACPC,QAAQ,GAKhB,IADA,IAAIU,GAAgB,EACXR,EAAID,EAAU,EAAQ,GAALC,EAAQA,IAAK,CACnC,IAAIM,EAAYpB,EAAWc,GAE3B,GAAInB,OAAO4B,cAAcH,IAAc5B,OAAOK,SAASL,OAAOgC,cAAcJ,GAAY1B,YAAYI,cAAgB,MAAO,CACvHwB,EAAeR,EACf,OAGR,IAAsB,IAAlBQ,EACA,MAAO,CACHX,OAAO,EACPC,QAAQ,GAKhB,IADA,IAAID,GAAQ,EACHG,EAAIQ,EAAe,EAAGR,GAAKD,EAAU,EAAGC,IAAK,CAC9CM,EAAYpB,EAAWc,GAE3B,GAAInB,OAAO8B,WAAWL,IAElB,GAAmC,KAA/BA,EAAUM,UAAUC,OAAe,CACnChB,GAAQ,EACR,YAMJ,IAFqBnB,OAAOK,SAASL,OAAOgC,cAAcJ,GAAY1B,YAAYI,cAAgB,WAE7E,CACjBa,GAAQ,EACR,OAIZ,MAAO,CACHA,MAAOA,EACPC,SAAQD,GACFhB,OAAOiC,eAAeC,KAAKrB,KAAMP,EAASC,EAAGG,aAAaX,YAAYI,cAAgB,aA5FpGV,QAAQG,WAAaA,WAgGrBH,QAAQE,aAAeA"}