{"version":3,"file":"renderRouterViewNode.js","sources":["compiler/renderRouterViewNode.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.renderRouterViewNode = void 0;\r\nvar vue_util_1 = require(\"@ctsj/vue-util\");\r\nvar util_1 = require(\"./directives/util\");\r\nvar for_1 = require(\"./directives/for\");\r\nvar if_1 = require(\"./directives/if\");\r\nvar else_1 = require(\"./directives/else\");\r\nvar else_if_1 = require(\"./directives/else-if\");\r\nvar util_2 = require(\"../core/util\");\r\nvar util_3 = require(\"../core/component/util\");\r\n/**\r\n * renderRouterViewNode - 渲染router-view元素\r\n * @param context - Object 上下文对象\r\n * @param el - HtmlElement 元素\r\n * @param parentVNode VNode\r\n * @param parentElement HtmlElement\r\n * @return VNode\r\n */\r\nfunction renderRouterViewNode(_a) {\r\n    var context = _a.context, el = _a.el, parentVNode = _a.parentVNode, parentElement = _a.parentElement;\r\n    var vAttrNames = util_1.getVAttrNames(el);\r\n    var key;\r\n    if (vAttrNames.length) {\r\n        // 解析el的v-for标签\r\n        if (for_1.hasVFor(vAttrNames)) {\r\n            // parse v-for\r\n            return for_1.parseVFor.call(this, \r\n            // 如果context是this.$dataProxy则需要重新创建新的context(上下文)，因为一个v-for就是一个新的上下文环境，因为v-for会有新的变量放入到this中\r\n            {\r\n                context: context,\r\n                // context === this.$dataProxy ? createContext.call(this, this.$dataProxy) : context,\r\n                el: el,\r\n                parentVNode: parentVNode,\r\n                vAttrNames: vAttrNames,\r\n                renderFun: renderRouterViewNode,\r\n            });\r\n        }\r\n        // 这个key属性可能是v-bind:key=，也可能是key=\r\n        key = util_1.getKey.call(this, { context: context, el: el });\r\n        // 解析v-if\r\n        if (if_1.hasVIf(vAttrNames)) {\r\n            // parse v-if\r\n            var display = if_1.parseVIf.call(this, { context: context, el: el, vAttrNames: vAttrNames });\r\n            if (!display) {\r\n                // 不显示这个节点\r\n                if (key) {\r\n                    // 有key属性则在componentsMap中删除这个组件的引用\r\n                    this.componentsMap.delete(key);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n        // 解析v-else\r\n        if (else_1.hasVElse(vAttrNames)) {\r\n            // 合理性判断\r\n            // 如果合理则进行计算\r\n            var entry = else_1.parseVElse.call(this, { context: context, el: el, parentElement: parentElement });\r\n            if (!entry.valid) {\r\n                if (key) {\r\n                    // 有key属性则在componentsMap中删除这个组件的引用\r\n                    this.componentsMap.delete(key);\r\n                }\r\n                return null;\r\n            }\r\n            if (!entry.result) {\r\n                if (key) {\r\n                    // 有key属性则在componentsMap中删除这个组件的引用\r\n                    this.componentsMap.delete(key);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n        // 解析v-else-if\r\n        if (else_if_1.hasVElseIf(vAttrNames)) {\r\n            // 合理性判断\r\n            // 如果合理则进行计算\r\n            var entry = else_if_1.parseVElseIf.call(this, { context: context, el: el, parentElement: parentElement });\r\n            if (!entry.valid) {\r\n                if (key) {\r\n                    // 有key属性则在componentsMap中删除这个组件的引用\r\n                    this.componentsMap.delete(key);\r\n                }\r\n                return null;\r\n            }\r\n            if (!entry.result) {\r\n                if (key) {\r\n                    // 有key属性则在componentsMap中删除这个组件的引用\r\n                    this.componentsMap.delete(key);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n    // 这个key属性可能是v-bind:key=，也可能是key=\r\n    key = util_1.getKey.call({ context: context, el: el });\r\n    // 根据路由配置获取component的组件，然后根据component反查tagName\r\n    // 创建tagName的元素\r\n    // 如果是vue实例\r\n    if (util_2.isVueInstance(this)) {\r\n        //  得到routes的配置数据\r\n        //  在\r\n        this.$router.getComponent();\r\n        //  得到浏览器的pathname\r\n    }\r\n    // 如果是组件\r\n    else if (util_3.isComponentInstance(this)) {\r\n        //  得到浏览器的pathname\r\n        //  组件的实例中需要有路由的配置项信息(重点)\r\n    }\r\n    // el没有key属性\r\n    if (vue_util_1.isEmpty(key)) {\r\n        key = vue_util_1.uuid();\r\n        el.setAttribute('key', key);\r\n    }\r\n}\r\nexports.renderRouterViewNode = renderRouterViewNode;\r\n"],"names":["Object","defineProperty","exports","value","renderRouterViewNode","vue_util_1","require","util_1","for_1","if_1","else_1","else_if_1","util_2","util_3","_a","context","el","parentVNode","parentElement","vAttrNames","getVAttrNames","length","hasVFor","parseVFor","call","this","renderFun","entry","key","getKey","hasVIf","parseVIf","componentsMap","delete","hasVElse","parseVElse","valid","result","hasVElseIf","parseVElseIf","isVueInstance","$router","getComponent","isComponentInstance","isEmpty","uuid","setAttribute"],"mappings":"aACAA,OAAOC,eAAeC,QAAS,aAAc,CAAEC,OAAO,IACtDD,QAAQE,0BAAuB,EAC/B,IAAIC,WAAaC,QAAQ,kBACrBC,OAASD,QAAQ,qBACjBE,MAAQF,QAAQ,oBAChBG,KAAOH,QAAQ,mBACfI,OAASJ,QAAQ,qBACjBK,UAAYL,QAAQ,wBACpBM,OAASN,QAAQ,gBACjBO,OAASP,QAAQ,0BASrB,SAASF,qBAAqBU,GAC1B,IAAIC,EAAUD,EAAGC,QAASC,EAAKF,EAAGE,GAAIC,EAAcH,EAAGG,YAAaC,EAAgBJ,EAAGI,cACnFC,EAAaZ,OAAOa,cAAcJ,GAEtC,GAAIG,EAAWE,OAAQ,CAEnB,GAAIb,MAAMc,QAAQH,GAEd,OAAOX,MAAMe,UAAUC,KAAKC,KAE5B,CACIV,QAASA,EAETC,GAAIA,EACJC,YAAaA,EACbE,WAAYA,EACZO,UAAWtB,uBAQf,IAkCIuB,EAtCRC,EAAMrB,OAAOsB,OAAOL,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,IAEvD,GAAIP,KAAKqB,OAAOX,GAGZ,IADcV,KAAKsB,SAASP,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,EAAIG,WAAYA,IAO3E,OAJIS,GAEAH,KAAKO,cAAcC,OAAOL,GAEvB,KAIf,GAAIlB,OAAOwB,SAASf,GAAa,CAI7B,KADIQ,EAAQjB,OAAOyB,WAAWX,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,EAAIE,cAAeA,KACzEkB,MAKP,OAJIR,GAEAH,KAAKO,cAAcC,OAAOL,GAEvB,KAEX,IAAKD,EAAMU,OAKP,OAJIT,GAEAH,KAAKO,cAAcC,OAAOL,GAEvB,KAIf,GAAIjB,UAAU2B,WAAWnB,GAAa,CAIlC,KADIQ,EAAQhB,UAAU4B,aAAaf,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,EAAIE,cAAeA,KAC9EkB,MAKP,OAJIR,GAEAH,KAAKO,cAAcC,OAAOL,GAEvB,KAEX,IAAKD,EAAMU,OAKP,OAJIT,GAEAH,KAAKO,cAAcC,OAAOL,GAEvB,MAKnBA,EAAMrB,OAAOsB,OAAOL,KAAK,CAAET,QAASA,EAASC,GAAIA,IAI7CJ,OAAO4B,cAAcf,MAGrBA,KAAKgB,QAAQC,eAIR7B,OAAO8B,oBAAoBlB,MAKhCpB,WAAWuC,QAAQhB,KACnBA,EAAMvB,WAAWwC,OACjB7B,EAAG8B,aAAa,MAAOlB,IAG/B1B,QAAQE,qBAAuBA"}