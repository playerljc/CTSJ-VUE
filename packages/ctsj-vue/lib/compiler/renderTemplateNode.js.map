{"version":3,"file":"renderTemplateNode.js","sources":["compiler/renderTemplateNode.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.renderTemplateNode = void 0;\r\nvar vue_util_1 = require(\"@ctsj/vue-util\");\r\nvar util_1 = require(\"./directives/util\");\r\nvar for_1 = require(\"./directives/for\");\r\nvar if_1 = require(\"./directives/if\");\r\nvar else_1 = require(\"./directives/else\");\r\nvar else_if_1 = require(\"./directives/else-if\");\r\nvar renderUtil_1 = require(\"./renderUtil\");\r\n/**\r\n * renderTemplateNode - 渲染template元素\r\n * @param context - Object 上下文对象\r\n * @param el - HtmlElement el元素\r\n * @param parentVNode - VNode 父元素VNode\r\n * @param parentElement - HtmlElement 父元素\r\n *\r\n * 1.<template></template> -> 什么都没有\r\n * 2.<template v-if=\"xxx\"></template> -> 有v-if\r\n * 3.<template v-for=\"item in list|obj\"></template> -> 有v-for\r\n * 4.<template v-slot:default></template> -> 有v-slot\r\n * @return VNode | Array | null\r\n */\r\nfunction renderTemplateNode(_a) {\r\n    var context = _a.context, el = _a.el, parentVNode = _a.parentVNode, parentElement = _a.parentElement;\r\n    var vAttrNames = util_1.getVAttrNames(el);\r\n    if (vAttrNames.length) {\r\n        // 解析el的v-for标签\r\n        if (for_1.hasVFor(vAttrNames)) {\r\n            // parse v-for\r\n            return for_1.parseVFor.call(this, \r\n            // 如果context是this.$dataProxy则需要重新创建新的context(上下文)，因为一个v-for就是一个新的上下文环境，因为v-for会有新的变量放入到this中\r\n            {\r\n                context: context,\r\n                // context === this.$dataProxy ? createContext.call(this, this.$dataProxy) : context,\r\n                el: el,\r\n                parentVNode: parentVNode,\r\n                vAttrNames: vAttrNames,\r\n                renderFun: renderTemplateNode,\r\n            });\r\n        }\r\n        // 解析v-if\r\n        if (if_1.hasVIf(vAttrNames)) {\r\n            // parse v-if\r\n            var display = if_1.parseVIf.call(this, { context: context, el: el, vAttrNames: vAttrNames });\r\n            // 如果不显示则返回null\r\n            if (!display) {\r\n                return null;\r\n            }\r\n        }\r\n        // 解析v-else\r\n        if (else_1.hasVElse(vAttrNames)) {\r\n            // 合理性判断\r\n            // 如果合理则进行计算\r\n            var entry = else_1.parseVElse.call(this, { context: context, el: el, parentElement: parentElement });\r\n            if (!entry.valid)\r\n                return null;\r\n            if (!entry.result)\r\n                return null;\r\n        }\r\n        // 解析v-else-if\r\n        if (else_if_1.hasVElseIf(vAttrNames)) {\r\n            // 合理性判断\r\n            // 如果合理则进行计算\r\n            var entry = else_if_1.parseVElseIf.call(this, { context: context, el: el, parentElement: parentElement });\r\n            if (!entry.valid)\r\n                return null;\r\n            if (!entry.result)\r\n                return null;\r\n        }\r\n    }\r\n    // loop template的children\r\n    var result = [];\r\n    for (var i = 0, len = el.content.childNodes.length; i < len; i++) {\r\n        var VNodes = renderUtil_1.renderLoop.call(this, {\r\n            context: context,\r\n            el: el.content.childNodes[i],\r\n            parentVNode: parentVNode,\r\n            parentElement: el,\r\n        });\r\n        if (!VNodes)\r\n            continue;\r\n        // v-for返回的\r\n        if (vue_util_1.isArray(VNodes)) {\r\n            result = result.concat(VNodes.filter(function (n) { return n; }));\r\n        }\r\n        else if (vue_util_1.isObject(VNodes)) {\r\n            result.push(VNodes);\r\n        }\r\n    }\r\n    return result;\r\n}\r\nexports.renderTemplateNode = renderTemplateNode;\r\n"],"names":["Object","defineProperty","exports","value","renderTemplateNode","vue_util_1","require","util_1","for_1","if_1","else_1","else_if_1","renderUtil_1","_a","entry","context","el","parentVNode","parentElement","vAttrNames","getVAttrNames","length","hasVFor","parseVFor","call","this","renderFun","hasVIf","parseVIf","hasVElse","parseVElse","valid","result","hasVElseIf","parseVElseIf","i","len","content","childNodes","VNodes","renderLoop","isArray","concat","filter","n","isObject","push"],"mappings":"aACAA,OAAOC,eAAeC,QAAS,aAAc,CAAEC,OAAO,IACtDD,QAAQE,wBAAqB,EAC7B,IAAIC,WAAaC,QAAQ,kBACrBC,OAASD,QAAQ,qBACjBE,MAAQF,QAAQ,oBAChBG,KAAOH,QAAQ,mBACfI,OAASJ,QAAQ,qBACjBK,UAAYL,QAAQ,wBACpBM,aAAeN,QAAQ,gBAc3B,SAASF,mBAAmBS,GACxB,IAwCYC,EAxCRC,EAAUF,EAAGE,QAASC,EAAKH,EAAGG,GAAIC,EAAcJ,EAAGI,YAAaC,EAAgBL,EAAGK,cACnFC,EAAaZ,OAAOa,cAAcJ,GACtC,GAAIG,EAAWE,OAAQ,CAEnB,GAAIb,MAAMc,QAAQH,GAEd,OAAOX,MAAMe,UAAUC,KAAKC,KAE5B,CACIV,QAASA,EAETC,GAAIA,EACJC,YAAaA,EACbE,WAAYA,EACZO,UAAWtB,qBAInB,GAAIK,KAAKkB,OAAOR,GAIZ,IAFcV,KAAKmB,SAASJ,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,EAAIG,WAAYA,IAG3E,OAAO,KAIf,GAAIT,OAAOmB,SAASV,GAAa,CAI7B,KADIL,EAAQJ,OAAOoB,WAAWN,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,EAAIE,cAAeA,KACzEa,MACP,OAAO,KACX,IAAKjB,EAAMkB,OACP,OAAO,KAGf,GAAIrB,UAAUsB,WAAWd,GAAa,CAIlC,KADIL,EAAQH,UAAUuB,aAAaV,KAAKC,KAAM,CAAEV,QAASA,EAASC,GAAIA,EAAIE,cAAeA,KAC9Ea,MACP,OAAO,KACX,IAAKjB,EAAMkB,OACP,OAAO,MAKnB,IADA,IAAIA,EAAS,GACJG,EAAI,EAAGC,EAAMpB,EAAGqB,QAAQC,WAAWjB,OAAQc,EAAIC,EAAKD,IAAK,CAC9D,IAAII,EAAS3B,aAAa4B,WAAWhB,KAAKC,KAAM,CAC5CV,QAASA,EACTC,GAAIA,EAAGqB,QAAQC,WAAWH,GAC1BlB,YAAaA,EACbC,cAAeF,IAEduB,IAGDlC,WAAWoC,QAAQF,GACnBP,EAASA,EAAOU,OAAOH,EAAOI,OAAO,SAAUC,GAAK,OAAOA,KAEtDvC,WAAWwC,SAASN,IACzBP,EAAOc,KAAKP,IAGpB,OAAOP,EAEX9B,QAAQE,mBAAqBA"}