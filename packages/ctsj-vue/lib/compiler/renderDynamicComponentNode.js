"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderDynamicComponentNode=void 0;var vue_util_1=require("@ctsj/vue-util"),util_1=require("./directives/util"),for_1=require("./directives/for"),if_1=require("./directives/if"),else_1=require("./directives/else"),else_if_1=require("./directives/else-if"),util_2=require("../core/util"),util_3=require("../core/component/util"),constants_1=require("../shared/constants"),renderComponentNode_1=require("./renderComponentNode");function renderDynamicComponentNode(e){var t=e.context,n=e.el,i=e.parentVNode,r=e.parentElement,o=util_1.getVAttrNames(n);if(o.length){if(for_1.hasVFor(o))return for_1.parseVFor.call(this,{context:t,el:n,parentVNode:i,vAttrNames:o,renderFun:renderDynamicComponentNode});var l=util_1.getKey.call(this,{context:t,el:n});if(if_1.hasVIf(o))if(!if_1.parseVIf.call(this,{context:t,el:n,vAttrNames:o}))return l&&this.componentsMap.delete(l),null;if(else_1.hasVElse(o)){e=else_1.parseVElse.call(this,{context:t,el:n,parentElement:r});if(!e.valid)return l&&this.componentsMap.delete(l),null;if(!e.result)return l&&this.componentsMap.delete(l),null}if(else_if_1.hasVElseIf(o)){var s=else_if_1.parseVElseIf.call(this,{context:t,el:n,parentElement:r});if(!s.valid)return l&&this.componentsMap.delete(l),null;if(!s.result)return l&&this.componentsMap.delete(l),null}}l=util_1.getKey.call({context:t,el:n});o=util_1.getAttribute.call(this,{context:t,attrName:"is",el:n});if(!o)return null;var s=!1,u=document.createElement(o);if(util_2.isVueInstance(this))s=util_3.isComponentNodeByVue(u);else{if(!util_3.isComponentInstance(this))return null;s=util_3.isComponentNodeByComponent(u,this.$getComponentsConfig())}if(!s)return null;var a=util_1.getAttributeName({attrName:"is",el:n});n.getAttributeNames().filter(function(e){return e!==a&&!e.startsWith(constants_1.DIRECT_PREFIX+"bind:key")&&"key"!==e}).forEach(function(e){return u.setAttribute(e,n.getAttribute(e))}),vue_util_1.isEmpty(l)&&(l=vue_util_1.uuid(),n.setAttribute("key",l),this.componentsMap.set(l,{componentName:o,key:vue_util_1.uuid()}));s=this.componentsMap.get(l);return vue_util_1.isEmpty(s)?this.componentsMap.set(l,{componentName:o,key:vue_util_1.uuid()}):s.componentName!==o&&(this.componentsMap.delete(s.key),s.componentName=o,s.key=vue_util_1.uuid()),s=this.componentsMap.get(l),u.setAttribute("key",s.key),renderComponentNode_1.renderComponentNode.call(this,{context:t,el:u,parentVNode:i,parentElement:r})}exports.renderDynamicComponentNode=renderDynamicComponentNode;
//# sourceMappingURL=renderDynamicComponentNode.js.map
