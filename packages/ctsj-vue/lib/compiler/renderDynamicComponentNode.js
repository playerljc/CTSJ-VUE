"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderDynamicComponentNode=void 0;var util_1=require("./directives/util"),for_1=require("./directives/for"),if_1=require("./directives/if"),else_1=require("./directives/else"),else_if_1=require("./directives/else-if"),util_2=require("../core/util"),util_3=require("../core/component/util"),constants_1=require("../shared/constants"),util_4=require("../shared/util"),uuid_1=__importDefault(require("../shared/uuid")),renderComponentNode_1=require("./renderComponentNode");function renderDynamicComponentNode(e){var t=e.context,n=e.el,r=e.parentVNode,i=e.parentElement,o=util_1.getVAttrNames(n);if(o.length){if(for_1.hasVFor(o))return for_1.parseVFor.call(this,{context:t,el:n,parentVNode:r,vAttrNames:o,renderFun:renderDynamicComponentNode});var l=util_1.getKey.call(this,{context:t,el:n});if(if_1.hasVIf(o))if(!if_1.parseVIf.call(this,{context:t,el:n,vAttrNames:o}))return l&&this.componentsMap.delete(l),null;if(else_1.hasVElse(o)){e=else_1.parseVElse.call(this,{context:t,el:n,parentElement:i});if(!e.valid)return l&&this.componentsMap.delete(l),null;if(!e.result)return l&&this.componentsMap.delete(l),null}if(else_if_1.hasVElseIf(o)){var s=else_if_1.parseVElseIf.call(this,{context:t,el:n,parentElement:i});if(!s.valid)return l&&this.componentsMap.delete(l),null;if(!s.result)return l&&this.componentsMap.delete(l),null}}l=util_1.getKey.call({context:t,el:n});o=util_1.getAttribute.call(this,{context:t,attrName:"is",el:n});if(!o)return null;var s=!1,u=document.createElement(o);if(util_2.isVueInstance(this))s=util_3.isComponentNodeByVue(u);else{if(!util_3.isComponentInstance(this))return null;s=util_3.isComponentNodeByComponent(u,this.$getComponentsConfig())}if(!s)return null;var a=util_1.getAttributeName({attrName:"is",el:n});n.getAttributeNames().filter(function(e){return e!==a&&!e.startsWith(constants_1.DIRECT_PREFIX+"bind:key")&&"key"!==e}).forEach(function(e){return u.setAttribute(e,n.getAttribute(e))}),util_4.isEmpty(l)&&(l=uuid_1.default(),n.setAttribute("key",l),this.componentsMap.set(l,{componentName:o,key:uuid_1.default()}));s=this.componentsMap.get(l);return util_4.isEmpty(s)?this.componentsMap.set(l,{componentName:o,key:uuid_1.default()}):s.componentName!==o&&(this.componentsMap.delete(s.key),s.componentName=o,s.key=uuid_1.default()),s=this.componentsMap.get(l),u.setAttribute("key",s.key),renderComponentNode_1.renderComponentNode.call(this,{context:t,el:u,parentVNode:r,parentElement:i})}exports.renderDynamicComponentNode=renderDynamicComponentNode;
//# sourceMappingURL=renderDynamicComponentNode.js.map
